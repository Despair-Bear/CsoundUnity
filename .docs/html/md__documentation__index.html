<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CsoundUnity: Documentation v3.2.0</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">CsoundUnity<span id="projectnumber">&#160;3.2.0</span>
   </div>
   <div id="projectbrief">Csound wrapper for the Unity game engine.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Documentation v3.2.0 </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><ul>
<li>How to import</li>
<li>Getting Started</li>
<li>Controlling Csound from Unity Scripts<ul>
<li>Csound's channel system</li>
<li>Starting / Stopping Instruments</li>
<li>Keeping Csound performance running</li>
</ul>
</li>
<li>Controlling Csound from the Unity Editor</li>
<li>CsoundUnityChild</li>
<li>CsoundFileWatcher</li>
<li>Supported Platforms</li>
</ul>
<p ><a class="anchor" id="importing"></a> </p>
<h1><a class="anchor" id="autotoc_md18"></a>
How to import</h1>
<p ><b>From version 3.0 <a class="el" href="class_csound_unity.html" title="Csound Unity Class">CsoundUnity</a> is in the form of a Unity Package</b>. See the <a href="https://docs.unity3d.com/Manual/PackagesList.html">Unity Manual</a> for more information. <br  />
</p>
<p >You should use the <b>Unity Package Manager</b> to import the <a class="el" href="class_csound_unity.html" title="Csound Unity Class">CsoundUnity</a> package in your project. <br  />
 To open the Package Manager in Unity, select <b>Window/PackageManager</b> from the top menu.</p>
<p ><b>If you have git installed</b>: press +, <em>Add package from git url...</em>, paste this url <a href="https://github.com/rorywalsh/CsoundUnity.git">https://github.com/rorywalsh/CsoundUnity.git</a>, and press Add.</p>
<p ><b>If you donâ€™t have git</b>: Download the Source Code (zip or tar.gz) of the <a href="https://github.com/rorywalsh/CsoundUnity/releases/latest">Latest Release</a> on your local disk, extract its content, press + in the Package Manager, <em>Add package from disk...</em>, and select the package.json inside the extracted folder. <br  />
</p>
<p ><a class="anchor" id="getting_started"></a> </p>
<h1><a class="anchor" id="autotoc_md19"></a>
Getting Started</h1>
<p ><a class="el" href="class_csound_unity.html" title="Csound Unity Class">CsoundUnity</a> is a simple component that can be added to any GameObject in a scene. To do so simple hit <b>AddComponent</b> in the inspector, then click <b>Audio</b> and add <b><a class="el" href="class_csound_unity.html" title="Csound Unity Class">CsoundUnity</a></b>.</p>
<p ><img src="images/addCsoundUnityComponent_v3.gif" alt="Add CsoundUnity" class="inline"/></p>
<p ><a class="el" href="class_csound_unity.html" title="Csound Unity Class">CsoundUnity</a> requires the presence of an AudioSource. If the GameObject you are trying to attach a <a class="el" href="class_csound_unity.html" title="Csound Unity Class">CsoundUnity</a> component to does not already have an AudioSource attached, one will be added automatically.</p>
<p >Once a <a class="el" href="class_csound_unity.html" title="Csound Unity Class">CsoundUnity</a> component has been added to a GameObject, you will need to attach a <a class="el" href="namespace_csound.html">Csound</a> file to it. <a class="el" href="namespace_csound.html">Csound</a> files can be placed anywhere inside the Assets folder. To attach a <a class="el" href="namespace_csound.html">Csound</a> file to a <a class="el" href="class_csound_unity.html" title="Csound Unity Class">CsoundUnity</a> component, simply drag it from the Assets folder to the 'Csd Asset' field in the <a class="el" href="class_csound_unity.html" title="Csound Unity Class">CsoundUnity</a> component inspector. When your game starts, <a class="el" href="namespace_csound.html">Csound</a> will feed audio from its output buffer into the AudioSource. Any audio produced by <a class="el" href="namespace_csound.html">Csound</a> can be accessed through the AudioSource component. It works for any amount of channels. See <a href="https://github.com/rorywalsh/CsoundUnity/blob/7f45fd3bfffa9f3d4760b0437d38de44b04a96e9/Runtime/CsoundUnity.cs#L1423"><b>CsoundUnity.ProcessBlock()</b></a></p>
<p ><img src="images/addCsoundFile_v3.gif" alt="Add Csound file" class="inline"/></p>
<p ><a class="anchor" id="controlling_csound_from_unity"></a> </p>
<h1><a class="anchor" id="autotoc_md20"></a>
Controlling Csound from Unity Scripts</h1>
<p >Once you have attached a <a class="el" href="namespace_csound.html">Csound</a> file to a <a class="el" href="class_csound_unity.html" title="Csound Unity Class">CsoundUnity</a> component, you may wish to control aspects of that instrument in realtime. <br  />
 Before calling any <a class="el" href="class_csound_unity.html" title="Csound Unity Class">CsoundUnity</a> methods, one must first access the component using the <b>GetComponent()</b> method. This can be seen in the sample scripts that follow. <br  />
 One usually calls GetComponent() in your script's <b>Awake()</b> or <b>Start()</b> methods. <br  />
 You should wait for <a class="el" href="namespace_csound.html">Csound</a> to be initialised before executing your code. Once the <a class="el" href="class_csound_unity.html" title="Csound Unity Class">CsoundUnity</a> component has been accessed, any of its member methods can be called.</p>
<p >See some examples below:</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="class_csound_unity.html">CsoundUnity</a> csound;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> Start()</div>
<div class="line">{</div>
<div class="line">    csound = GetComponent&lt;CsoundUnity&gt;();        </div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> Update()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (!csound.<a class="code hl_property" href="class_csound_unity.html#ae2c648d0f6245fb84c5f9ec5176079ff">IsInitialized</a>) <span class="keywordflow">return</span>;</div>
<div class="line">    <span class="comment">// your code</span></div>
<div class="line">}</div>
<div class="ttc" id="aclass_csound_unity_html"><div class="ttname"><a href="class_csound_unity.html">CsoundUnity</a></div><div class="ttdoc">Csound Unity Class</div><div class="ttdef"><b>Definition:</b> <a href="_csound_unity_8cs_source.html#l00136">CsoundUnity.cs:137</a></div></div>
<div class="ttc" id="aclass_csound_unity_html_ae2c648d0f6245fb84c5f9ec5176079ff"><div class="ttname"><a href="class_csound_unity.html#ae2c648d0f6245fb84c5f9ec5176079ff">CsoundUnity.IsInitialized</a></div><div class="ttdeci">bool IsInitialized</div><div class="ttdoc">Is Csound initialized?</div><div class="ttdef"><b>Definition:</b> <a href="_csound_unity_8cs_source.html#l00224">CsoundUnity.cs:224</a></div></div>
</div><!-- fragment --><div class="fragment"><div class="line"><a class="code hl_class" href="class_csound_unity.html">CsoundUnity</a> csound;</div>
<div class="line"> </div>
<div class="line">IEnumerator Start()</div>
<div class="line">{</div>
<div class="line">    csound = GetComponent&lt;CsoundUnity&gt;();</div>
<div class="line">    <span class="keywordflow">while</span> (!csound.<a class="code hl_property" href="class_csound_unity.html#ae2c648d0f6245fb84c5f9ec5176079ff">IsInitialized</a>)</div>
<div class="line">    {</div>
<div class="line">        yield <span class="keywordflow">return</span> <span class="keyword">null</span>;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// your code</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Update is called once per frame</span></div>
<div class="line"><span class="keywordtype">void</span> Update()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (!csound.<a class="code hl_property" href="class_csound_unity.html#ae2c648d0f6245fb84c5f9ec5176079ff">IsInitialized</a>) <span class="keywordflow">return</span>;</div>
<div class="line">    <span class="comment">// your code</span></div>
<div class="line">}</div>
</div><!-- fragment --><div class="fragment"><div class="line"><a class="code hl_class" href="class_csound_unity.html">CsoundUnity</a> csound;</div>
<div class="line"><span class="keyword">private</span> <span class="keywordtype">bool</span> initialized;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span> <span class="keywordtype">void</span> Start()</div>
<div class="line">{</div>
<div class="line">    csound = GetComponent&lt;CsoundUnity&gt;();</div>
<div class="line">    csound.<a class="code hl_event" href="class_csound_unity.html#a066fb6573f60c343aebb79f7a202cac5">OnCsoundInitialized</a> += OnCsoundInitialized;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span> <span class="keywordtype">void</span> OnCsoundInitialized()</div>
<div class="line">{</div>
<div class="line">    initialized = <span class="keyword">true</span>;</div>
<div class="line">    Debug.Log(<span class="stringliteral">&quot;Csound initialised!&quot;</span>);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// your code</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Update is called once per frame</span></div>
<div class="line"><span class="keywordtype">void</span> Update()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (!initialized) <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// your code</span></div>
<div class="line">}</div>
<div class="ttc" id="aclass_csound_unity_html_a066fb6573f60c343aebb79f7a202cac5"><div class="ttname"><a href="class_csound_unity.html#a066fb6573f60c343aebb79f7a202cac5">CsoundUnity.OnCsoundInitialized</a></div><div class="ttdeci">CsoundInitialized OnCsoundInitialized</div><div class="ttdoc">An event that will be executed when Csound is initialized</div><div class="ttdef"><b>Definition:</b> <a href="_csound_unity_8cs_source.html#l00233">CsoundUnity.cs:233</a></div></div>
</div><!-- fragment --><p ><a class="anchor" id="csound-s-channel-system"></a> </p>
<h2><a class="anchor" id="autotoc_md21"></a>
Csound's channel system</h2>
<p ><a class="el" href="namespace_csound.html">Csound</a> allows data to be sent and received over its channel system. To access data in <a class="el" href="namespace_csound.html">Csound</a>, one must use the <b>chnget</b> opcode. In the following code example, we access data being sent from Unity to Csoud on a channel named <em>speed</em>. The variable kSpeed will constantly update according to the value stored on the channel named <em>speed</em>.</p>
<p ><img src="http://rorywalsh.github.io/CsoundUnity/images/chnget.png" alt="chnget" class="inline"/></p>
<p >In order to send data from Unity to <a class="el" href="namespace_csound.html">Csound</a> we must use the <a href="https://github.com/rorywalsh/CsoundUnity/blob/7f45fd3bfffa9f3d4760b0437d38de44b04a96e9/Runtime/CsoundUnity.cs#L812"><b>CsoundUnity.SetChannel(string channel, MYFLT value)</b></a> method. See the <b>Update()</b> method of the script below:</p>
<div class="fragment"><div class="line"><span class="comment">// C# code</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using</span> UnityEngine;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span> <span class="keyword">class </span><a class="code hl_class" href="class_cube_controller.html">CubeController</a> : MonoBehaviour </div>
<div class="line">{</div>
<div class="line">    <span class="keyword">private</span> <a class="code hl_class" href="class_csound_unity.html">CsoundUnity</a> csoundUnity;</div>
<div class="line">    <span class="keyword">private</span> CharacterController controller;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> Start()</div>
<div class="line">    {</div>
<div class="line">        csoundUnity = GetComponent&lt;CsoundUnity&gt;();</div>
<div class="line">        controller = GetComponent&lt;CharacterController&gt;();</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">void</span> Update()</div>
<div class="line">    {</div>
<div class="line">        transform.Rotate(0, Input.GetAxis(<span class="stringliteral">&quot;Horizontal&quot;</span>) * 100, 0);</div>
<div class="line">        var forward = transform.TransformDirection(Vector3.forward);</div>
<div class="line">        var curSpeed = 10 * Input.GetAxis(<span class="stringliteral">&quot;Vertical&quot;</span>);</div>
<div class="line">        controller.Simplemove(forward * curSpeed);</div>
<div class="line">        csoundUnity.<a class="code hl_function" href="class_csound_unity.html#a3dda8229f389f764b916d80d9d136c57">SetChannel</a>(<span class="stringliteral">&quot;speed&quot;</span>, controller.velocity.magnitude / 3f);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="aclass_csound_unity_html_a3dda8229f389f764b916d80d9d136c57"><div class="ttname"><a href="class_csound_unity.html#a3dda8229f389f764b916d80d9d136c57">CsoundUnity.SetChannel</a></div><div class="ttdeci">void SetChannel(string channel, MYFLT val)</div><div class="ttdoc">Sets a Csound channel. Used in connection with a chnget opcode in your Csound instrument.</div><div class="ttdef"><b>Definition:</b> <a href="_csound_unity_8cs_source.html#l00812">CsoundUnity.cs:812</a></div></div>
<div class="ttc" id="aclass_cube_controller_html"><div class="ttname"><a href="class_cube_controller.html">CubeController</a></div><div class="ttdef"><b>Definition:</b> <a href="_cube_controller_8cs_source.html#l00005">CubeController.cs:6</a></div></div>
</div><!-- fragment --><p >Other examples: </p><div class="fragment"><div class="line"><span class="comment">// C# code</span></div>
<div class="line"><span class="keywordflow">if</span> (csoundUnity)</div>
<div class="line">    csoundUnity.<a class="code hl_function" href="class_csound_unity.html#a3dda8229f389f764b916d80d9d136c57">SetChannel</a>(<span class="stringliteral">&quot;BPM&quot;</span>, BPM);</div>
</div><!-- fragment --><div class="fragment"><div class="line">;csd file</div>
<div class="line">kBPM = abs(chnget:k(<span class="stringliteral">&quot;BPM&quot;</span>))</div>
</div><!-- fragment --><p ><a class="anchor" id="starting---stopping-instruments"></a> </p>
<h2><a class="anchor" id="autotoc_md22"></a>
Starting / Stopping Instruments</h2>
<p >You can start an instrument to play at any time using the <a href="https://github.com/rorywalsh/CsoundUnity/blob/7f45fd3bfffa9f3d4760b0437d38de44b04a96e9/Runtime/CsoundUnity.cs#L493"><b>CsoundUnity.SendScoreEvent(string scoreEvent)</b></a> method:</p>
<div class="fragment"><div class="line"><span class="comment">// C# code</span></div>
<div class="line"><span class="comment">// this will instantly play instrument #1 for 10 seconds</span></div>
<div class="line">csoundUnity.<a class="code hl_function" href="class_csound_unity.html#a67eb0ef59ebe2b06a17cbfe362d03122">SendScoreEvent</a>(<span class="stringliteral">&quot;i1 0 10&quot;</span>);</div>
<div class="ttc" id="aclass_csound_unity_html_a67eb0ef59ebe2b06a17cbfe362d03122"><div class="ttname"><a href="class_csound_unity.html#a67eb0ef59ebe2b06a17cbfe362d03122">CsoundUnity.SendScoreEvent</a></div><div class="ttdeci">void SendScoreEvent(string scoreEvent)</div><div class="ttdoc">Send a score event to Csound in the form of &quot;i1 0 10 ....</div><div class="ttdef"><b>Definition:</b> <a href="_csound_unity_8cs_source.html#l00493">CsoundUnity.cs:493</a></div></div>
</div><!-- fragment --><p >You can specify the time to wait before starting the instrument:</p>
<div class="fragment"><div class="line"><span class="comment">// C# code</span></div>
<div class="line"><span class="comment">// start instrument #1 after 5 seconds, with 10 seconds duration</span></div>
<div class="line">csoundUnity.<a class="code hl_function" href="class_csound_unity.html#a67eb0ef59ebe2b06a17cbfe362d03122">SendScoreEvent</a>(<span class="stringliteral">&quot;i1 5 10&quot;</span>);</div>
</div><!-- fragment --><p >You can also stop a running instrument, but only if it has been started with indefinite duration (so it will keep running until you stop it), setting the duration parameter to -1:</p>
<div class="fragment"><div class="line"><span class="comment">// C# code</span></div>
<div class="line"><span class="comment">// instantly start instrument #1 with an indefinite duration</span></div>
<div class="line">csoundUnity.<a class="code hl_function" href="class_csound_unity.html#a67eb0ef59ebe2b06a17cbfe362d03122">SendScoreEvent</a>(<span class="stringliteral">&quot;i1 0 -1&quot;</span>);</div>
</div><!-- fragment --><p >To stop an instrument, set its number negative:</p>
<div class="fragment"><div class="line"><span class="comment">// C# code</span></div>
<div class="line"><span class="comment">// instantly stop instrument #1</span></div>
<div class="line">csoundUnity.<a class="code hl_function" href="class_csound_unity.html#a67eb0ef59ebe2b06a17cbfe362d03122">SendScoreEvent</a>(<span class="stringliteral">&quot;i-1 0 -1&quot;</span>);</div>
</div><!-- fragment --><p ><a class="anchor" id="keeping-csound-performance-running"></a> </p>
<h2><a class="anchor" id="autotoc_md23"></a>
Keeping Csound performance running</h2>
<p >Be aware that <a class="el" href="namespace_csound.html">Csound</a> will stop its performance if all the instruments (the ones listed in the score and the ones started from Unity) have stopped playing. <br  />
 You won't be able to restart the <a class="el" href="namespace_csound.html">Csound</a> performance with the current implementation of <a class="el" href="class_csound_unity.html" title="Csound Unity Class">CsoundUnity</a>. <br  />
 Instead, if you want to keep the performance active for all the time your application is running, be sure to add one of those lines to the <a class="el" href="namespace_csound.html">Csound</a> score:</p>
<div class="fragment"><div class="line">&lt;CsScore&gt;</div>
<div class="line">;causes Csound to run for about 7000 years...</div>
<div class="line">f0 z </div>
<div class="line">&lt;/CsScore&gt;</div>
</div><!-- fragment --><div class="fragment"><div class="line">&lt;CsScore&gt;</div>
<div class="line">;causes instrument 1 to run for about 7000 years...</div>
<div class="line">i1 0 z</div>
<div class="line">&lt;/CsScore&gt;</div>
</div><!-- fragment --><div class="fragment"><div class="line">&lt;CsScore&gt;</div>
<div class="line">;causes instrument 1 to run for a day</div>
<div class="line">i1 0 [24*60*60]</div>
<div class="line">&lt;/CsScore&gt;</div>
</div><!-- fragment --><p >More information about scores here: <br  />
 <a href="https://csound.com/docs/manual/ScoreTop.html">https://csound.com/docs/manual/ScoreTop.html</a> <br  />
 <a href="https://csound.com/docs/manual/ScoreEval.html">https://csound.com/docs/manual/ScoreEval.html</a></p>
<p ><a class="anchor" id="controlling_csound_from_unity_editor"></a> </p>
<h1><a class="anchor" id="autotoc_md24"></a>
Controlling Csound from the Unity Editor</h1>
<p >You can control <a class="el" href="namespace_csound.html">Csound</a> channels using the Unity Editor while you are developing your game's sounds. <br  />
 To do so, you must provide a short &lt;Cabbage&gt;&lt;/Cabbage&gt; descriptor at the top of your <a class="el" href="namespace_csound.html">Csound</a> files describing the channels that are needed. <br  />
 This simple descriptor section uses a single line of code to describe each channel. <br  />
 Each line starts with the given channel's controller type and is then followed by combination of other identifiers such as <em>channel()</em>, <em>text()</em>, and <em>range()</em>. <br  />
 The following descriptor sets up 3 channel controllers. A slider, a button and a checkbox(toggle). </p><div class="fragment"><div class="line">;csd file</div>
<div class="line">&lt;Cabbage&gt;</div>
<div class="line">form caption(&quot;SimpleFreq&quot;)</div>
<div class="line">hslider channel(&quot;freq1&quot;), text(&quot;Frequency Slider&quot;), range(0, 10000, 0)</div>
<div class="line">button channel(&quot;trigger&quot;), text(&quot;Push me&quot;)</div>
<div class="line">checkbox channel(&quot;mute&quot;)</div>
<div class="line">&lt;/Cabbage&gt;</div>
</div><!-- fragment --><p >Each control MUST specify a channel. <br  />
 The <em><b>range()</b></em> identifier must be used if the controller type is a slider. <br  />
 The <em><b>text()</b></em> identifier can be used to display unique text beside a control but it is not required. If it is left out, the channel() name will be used as the control's label. The caption() identifier, used with form, is used to display some simple help text to the user.</p>
<p >See <a href="https://cabbageaudio.com/docs/cabbage_syntax/"><b>Cabbage Widgets</b></a> for more information about the syntax to use. <a class="el" href="class_csound_unity.html" title="Csound Unity Class">CsoundUnity</a> aims to support most of the (relevant) Widgets available in Cabbage. <br  />
 <a href="https://cabbageaudio.com/">Cabbage</a> is a framework for audio software development, with it you can create wonderful VST/AU plugins based on <a class="el" href="namespace_csound.html">Csound</a>. <br  />
 And of course it is a great <a class="el" href="namespace_csound.html">Csound</a> IDE! <br  />
 You will find a lot of examples inside it: be aware that most of them are not supported at the moment in <a class="el" href="class_csound_unity.html" title="Csound Unity Class">CsoundUnity</a>, since the Widgets support is still limited. But they're worth a try! <br  />
 Feel free to ask on the <a href="https://forum.cabbageaudio.com/"><b>Cabbage Forum</b></a> for any Cabbage example that you would like to be added to <a class="el" href="class_csound_unity.html" title="Csound Unity Class">CsoundUnity</a> as a sample.</p>
<p >When a <a class="el" href="namespace_csound.html">Csound</a> file which contains a valid &lt; Cabbage &gt; section is dragged to a <a class="el" href="class_csound_unity.html" title="Csound Unity Class">CsoundUnity</a> component, Unity will generate controls for each channel. <br  />
 These controls can be tweaked when your game is running. Each time a control is modified, its value is sent to <a class="el" href="namespace_csound.html">Csound</a> from Unity on the associated channel. In this way it works the same as the method above, only we don't have to code anything in order to test our sound. <br  />
 If you change a channel value via C# code, you will see its value updated in the editor. <br  />
 For now, <a class="el" href="class_csound_unity.html" title="Csound Unity Class">CsoundUnity</a> support only four types of controller: <em>slider</em>, <em>checkbox(toggle)</em>, <em>button</em> and <em>comboboxes</em>.</p>
<p ><a class="anchor" id="csoundunity_child"></a> </p>
<h1><a class="anchor" id="autotoc_md25"></a>
CsoundUnityChild</h1>
<p >New in version 3.0, the <a class="el" href="class_csound_unity_child.html" title="CsoundUnityChild is a component that can output AudioChannels found in the csd of the associated Csou...">CsoundUnityChild</a> component lets you read the AudioChannels found in a <a class="el" href="class_csound_unity.html" title="Csound Unity Class">CsoundUnity</a> instance. You can have as many audio channels you want in your Csd. <br  />
 You can set them with the <em>chnset</em> opcode. <br  />
 See the example below: </p><div class="fragment"><div class="line">;csd file</div>
<div class="line">&lt;Cabbage&gt;</div>
<div class="line">form caption(&quot;Test CsoundUnityChild&quot;) </div>
<div class="line">rslider channel(&quot;gain&quot;), range(0, 1, .4, 1, .01), text(&quot;Gain&quot;)</div>
<div class="line">rslider range(0, 1, 1, 1, 0.001), channel(&quot;hrm1&quot;)</div>
<div class="line">rslider range(0, 1, 0, 1, 0.001), channel(&quot;hrm2&quot;)</div>
<div class="line">rslider range(0, 1, 0, 1, 0.001), channel(&quot;hrm3&quot;)</div>
<div class="line">rslider range(0, 1, 0, 1, 0.001), channel(&quot;hrm4&quot;)</div>
<div class="line">&lt;/Cabbage&gt;</div>
<div class="line">&lt;CsoundSynthesizer&gt;</div>
<div class="line">&lt;CsOptions&gt;</div>
<div class="line">-n -d </div>
<div class="line">&lt;/CsOptions&gt;</div>
<div class="line">&lt;CsInstruments&gt;</div>
<div class="line">; Initialize the global variables. </div>
<div class="line">ksmps = 32</div>
<div class="line">nchnls = 2</div>
<div class="line">0dbfs = 1</div>
<div class="line"> </div>
<div class="line">giWave1 ftgen 1, 0, 4096, 10, 1</div>
<div class="line">giWave2 ftgen 1, 0, 4096, 10, 1, .5, .25, .17</div>
<div class="line"> </div>
<div class="line">;this instrument sends audio to two named channels</div>
<div class="line">;this audio can be picked up by any CsoundUnityChild component..</div>
<div class="line">instr ChildSounds</div>
<div class="line">    a1 oscili 1, 440, giWave1</div>
<div class="line">    chnset a1, &quot;sound1&quot;</div>
<div class="line">    a2 oscili 1, 840, giWave1</div>
<div class="line">    chnset a2, &quot;sound2&quot;</div>
<div class="line">endin</div>
<div class="line"> </div>
<div class="line">&lt;/CsInstruments&gt;</div>
<div class="line">&lt;CsScore&gt;</div>
<div class="line">;causes Csound to run for about 7000 years...</div>
<div class="line">f0 z</div>
<div class="line">i&quot;ChildSounds&quot; 0 z</div>
<div class="line">&lt;/CsScore&gt;</div>
<div class="line">&lt;/CsoundSynthesizer&gt;</div>
</div><!-- fragment --><p >To be able to pick those named channels, create a GameObject and add the <a class="el" href="class_csound_unity_child.html" title="CsoundUnityChild is a component that can output AudioChannels found in the csd of the associated Csou...">CsoundUnityChild</a> component. An AudioSource will be added if there is none. <br  />
 There you can choose the AudioChannels that this <a class="el" href="class_csound_unity_child.html" title="CsoundUnityChild is a component that can output AudioChannels found in the csd of the associated Csou...">CsoundUnityChild</a> will play and in which configuration. <br  />
 If AudioChannelsSetting is set to MONO, the selected AudioChannel will be played in both LEFT and RIGHT channel, at half volume, to have it perfectly centered. <br  />
 If AudioChannelsSetting is set to STEREO, the selected AudioChannels will use the respective output channel.</p>
<p ><img src="images/setupCsoundUnityChild_v3.gif" alt="CsoundUnityChild" class="inline"/></p>
<p ><b>Be aware that the support for audio channels is still limited</b>: they're parsed from the csd file, meaning that if you're using variables the <a class="el" href="class_csound_unity_editor.html">CsoundUnityEditor</a> parser won't recognize them. <br  />
 The following example will find an audioChannel named "*Sname*", instead of its expected value of "*audioChannel_1*": <br  />
</p>
<div class="fragment"><div class="line">;csd file</div>
<div class="line">instr 1</div>
<div class="line">kEnv madsr .1, .2, .6, .4</div>
<div class="line">aOut vco2 p5, p4</div>
<div class="line">inumber = 1</div>
<div class="line">Sname sprintf &quot;audioChannel_%02d&quot;, inumber</div>
<div class="line">chnset aOut, Sname </div>
<div class="line">outs aOut*kEnv, aOut*kEnv</div>
<div class="line">endin</div>
</div><!-- fragment --><p >You can also create the <a class="el" href="class_csound_unity.html" title="Csound Unity Class">CsoundUnity</a> children with code, for more advanced setups. You can get the available audio channels from <a class="el" href="class_csound_unity.html" title="Csound Unity Class">CsoundUnity</a> with:</p>
<div class="fragment"><div class="line"><span class="comment">//C# code</span></div>
<div class="line">var audioChannels = csoundUnity.<a class="code hl_property" href="class_csound_unity.html#ae00b36e523ed56c3d80c1930bec1a30e">availableAudioChannels</a>;</div>
<div class="ttc" id="aclass_csound_unity_html_ae00b36e523ed56c3d80c1930bec1a30e"><div class="ttname"><a href="class_csound_unity.html#ae00b36e523ed56c3d80c1930bec1a30e">CsoundUnity.availableAudioChannels</a></div><div class="ttdeci">List&lt; string &gt; availableAudioChannels</div><div class="ttdoc">list to hold available audioChannels names</div><div class="ttdef"><b>Definition:</b> <a href="_csound_unity_8cs_source.html#l00214">CsoundUnity.cs:214</a></div></div>
</div><!-- fragment --><p >To be able to initialize a child, you should call <a href="https://github.com/rorywalsh/CsoundUnity/blob/7f45fd3bfffa9f3d4760b0437d38de44b04a96e9/Runtime/CsoundUnityChild.cs#L127">CsoundUnityChildren.Init(CsoundUnity csound, AudioChannels audioChannels)</a>, to set the reference to the <a class="el" href="class_csound_unity.html" title="Csound Unity Class">CsoundUnity</a> instance that has available audio channels, and to define the channel setup to use (MONO or STEREO). Then you must specify the audio channel you want to use with <a href="https://github.com/rorywalsh/CsoundUnity/blob/7f45fd3bfffa9f3d4760b0437d38de44b04a96e9/Runtime/CsoundUnityChild.cs#L143">SetAudioChannel(int channel, int audioChannel)</a>: the channel parameter is the LEFT (0) or RIGHT (1) channel, the audioChannel parameter is the index of the <em>CsoundUnity.availableAudioChannel</em> you want to use. See the example that follows:</p>
<div class="fragment"><div class="line"><span class="comment">// C# code  </span></div>
<div class="line">  </div>
<div class="line">[Tooltip(<span class="stringliteral">&quot;The radius of the circle where the children will be placed, starting from the position of this GameObject&quot;</span>)]</div>
<div class="line">[SerializeField] <span class="keyword">private</span> <span class="keywordtype">float</span> _radius = 200f;</div>
<div class="line">[Tooltip(<span class="stringliteral">&quot;How many meters more the sources will be audible from. This value will be summed to the radius. &quot;</span> +</div>
<div class="line">  <span class="stringliteral">&quot;It is to make sure that there will be some sound when the player is equidistant from the sources&quot;</span>)]</div>
<div class="line">[SerializeField] <span class="keyword">private</span> <span class="keywordtype">float</span> _rollofTolerance = 100f;</div>
<div class="line">[Tooltip(<span class="stringliteral">&quot;The CsoundUnity children prefab&quot;</span>)]</div>
<div class="line">[SerializeField] <span class="keyword">private</span> GameObject _childPrefab;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span> <a class="code hl_class" href="class_csound_unity.html">CsoundUnity</a> _csound;</div>
<div class="line"> </div>
<div class="line">IEnumerator Start()</div>
<div class="line">{</div>
<div class="line">    _csound = GetComponent&lt;CsoundUnity&gt;();</div>
<div class="line">    <span class="keywordflow">while</span> (!_csound.<a class="code hl_property" href="class_csound_unity.html#ae2c648d0f6245fb84c5f9ec5176079ff">IsInitialized</a>)</div>
<div class="line">        yield <span class="keywordflow">return</span> <span class="keyword">null</span>;</div>
<div class="line"> </div>
<div class="line">    var n = _csound.<a class="code hl_property" href="class_csound_unity.html#ae00b36e523ed56c3d80c1930bec1a30e">availableAudioChannels</a>.Count;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (var i = 0; i &lt; n; i++)</div>
<div class="line">    {</div>
<div class="line">        var angle = i * Mathf.PI * 2 / n;</div>
<div class="line">        var pos = <span class="keyword">new</span> Vector3(Mathf.Cos(angle), 0,  Mathf.Sin(angle)) * _radius;</div>
<div class="line">        var go = Instantiate(_childPrefab, this.transform);</div>
<div class="line"> </div>
<div class="line">        go.transform.position = pos;</div>
<div class="line">        var child = go.AddComponent&lt;<a class="code hl_class" href="class_csound_unity_child.html">CsoundUnityChild</a>&gt;();</div>
<div class="line">        child.<a class="code hl_function" href="class_csound_unity_child.html#af687ae511d8bdcae7970f12b5b49c058">Init</a>(_csound, <a class="code hl_class" href="class_csound_unity_child.html">CsoundUnityChild</a>.<a class="code hl_enumeration" href="class_csound_unity_child.html#a327fcfb29d015b5607f6222853b6438c">AudioChannels</a>.MONO);</div>
<div class="line">        child.SetAudioChannel(0, i);</div>
<div class="line">        child.name = _csound.<a class="code hl_property" href="class_csound_unity.html#ae00b36e523ed56c3d80c1930bec1a30e">availableAudioChannels</a>[i];</div>
<div class="line">        var aS = go.GetComponent&lt;AudioSource&gt;();</div>
<div class="line">        <span class="comment">// set doppler level to 0 to avoid artefacts when the camera moves</span></div>
<div class="line">        aS.dopplerLevel = 0;</div>
<div class="line">        aS.rolloffMode = AudioRolloffMode.Custom;</div>
<div class="line">        <span class="comment">// when the audio listener is &#39;radius&#39; meters far from the audio source, there will be no sound, </span></div>
<div class="line">        <span class="comment">// since the rolloff function will lower the volume accordingly to the custom curve, and at maxDistance the volume will be 0. </span></div>
<div class="line">        <span class="comment">// Let&#39;s add &#39;rollofTolerance&#39; meters more to have some sound when the listener is equidistant from the created sources</span></div>
<div class="line">        aS.maxDistance = _radius + _rollofTolerance;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="aclass_csound_unity_child_html"><div class="ttname"><a href="class_csound_unity_child.html">CsoundUnityChild</a></div><div class="ttdoc">CsoundUnityChild is a component that can output AudioChannels found in the csd of the associated Csou...</div><div class="ttdef"><b>Definition:</b> <a href="_csound_unity_child_8cs_source.html#l00041">CsoundUnityChild.cs:42</a></div></div>
<div class="ttc" id="aclass_csound_unity_child_html_a327fcfb29d015b5607f6222853b6438c"><div class="ttname"><a href="class_csound_unity_child.html#a327fcfb29d015b5607f6222853b6438c">CsoundUnityChild.AudioChannels</a></div><div class="ttdeci">AudioChannels</div><div class="ttdef"><b>Definition:</b> <a href="_csound_unity_child_8cs_source.html#l00049">CsoundUnityChild.cs:49</a></div></div>
<div class="ttc" id="aclass_csound_unity_child_html_af687ae511d8bdcae7970f12b5b49c058"><div class="ttname"><a href="class_csound_unity_child.html#af687ae511d8bdcae7970f12b5b49c058">CsoundUnityChild.Init</a></div><div class="ttdeci">void Init(CsoundUnity csound, AudioChannels audioChannels=AudioChannels.MONO)</div><div class="ttdef"><b>Definition:</b> <a href="_csound_unity_child_8cs_source.html#l00127">CsoundUnityChild.cs:127</a></div></div>
</div><!-- fragment --><p ><a class="anchor" id="csound_filewatcher"></a> </p>
<h1><a class="anchor" id="autotoc_md26"></a>
CsoundFileWatcher</h1>
<p >From version 3.0 <a class="el" href="class_csound_unity.html" title="Csound Unity Class">CsoundUnity</a> can detect the changes made to the <em>csd</em> file while modifying it in an external editor. <br  />
 You will see in the Unity Console messages like this:</p>
<div class="fragment"><div class="line">[CsoundFileWatcher] Updating csd: sfload.csd in GameObject: Csound</div>
</div><!-- fragment --><p >when this happens. This means that you don't need to drag the Csd Asset in <a class="el" href="class_csound_unity.html" title="Csound Unity Class">CsoundUnity</a> everytime you make a change on it in an external editor.</p>
<p ><a class="anchor" id="platforms"></a> </p>
<h1><a class="anchor" id="autotoc_md27"></a>
Supported Platforms</h1>
<p ><a class="el" href="class_csound_unity.html" title="Csound Unity Class">CsoundUnity</a> supports building for Windows, macOS, Android 64bit (it has successfully been tested on Oculus Quest) and iOS 64bit. <br  />
 We are planning to add WebGL support, but unfortunately Unity WebGL doesn't support AudioSource.OnAudioFilterRead callback, meaning that we are not able to use the same approach we're using for the other platforms. <br  />
 This means that adding WebGL support could take a while! </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
