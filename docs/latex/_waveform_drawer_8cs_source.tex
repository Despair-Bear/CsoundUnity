\hypertarget{_waveform_drawer_8cs_source}{}\doxysection{Waveform\+Drawer.\+cs}
\label{_waveform_drawer_8cs_source}\index{Samples$\sim$/GranularSynthesis/Scripts/WaveformDrawer.cs@{Samples$\sim$/GranularSynthesis/Scripts/WaveformDrawer.cs}}
\mbox{\hyperlink{_waveform_drawer_8cs}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00001}00001 \textcolor{keyword}{using} UnityEngine;}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00002}00002 \textcolor{keyword}{using} UnityEngine.UI;}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00003}00003 }
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00004}00004 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespace_csound_1_1_granular_synthesis_1_1_partikkel}{Csound.GranularSynthesis.Partikkel}}}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00005}00005 \{}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00006}00006     [RequireComponent(typeof(\mbox{\hyperlink{class_csound_unity}{CsoundUnity}}))]}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00007}\mbox{\hyperlink{class_csound_1_1_granular_synthesis_1_1_partikkel_1_1_waveform_drawer}{00007}}     \textcolor{keyword}{public} \textcolor{keyword}{class }\mbox{\hyperlink{class_csound_1_1_granular_synthesis_1_1_partikkel_1_1_waveform_drawer}{WaveformDrawer}} : MonoBehaviour}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00008}00008     \{}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00009}00009         [Tooltip(\textcolor{stringliteral}{"{}The raw image where the waveform will be drawn"{}})]}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00010}00010         [SerializeField] RawImage \_targetImage;}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00011}00011         [Tooltip(\textcolor{stringliteral}{"{}The audioclip that will be used as a source"{}})]}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00012}00012         [SerializeField] AudioClip \_clip;}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00013}00013         [Tooltip(\textcolor{stringliteral}{"{}The progress bar that will be updated using a Csound Control Channel"{}})]}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00014}00014         [SerializeField] Image \_progressBar;}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00015}00015 }
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00016}00016         \textcolor{keyword}{private} RectTransform \_progressBarRT;}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00017}00017         \textcolor{keyword}{private} \textcolor{keywordtype}{float} \_targetImageWidth;}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00018}00018         \textcolor{keyword}{private} \mbox{\hyperlink{class_csound_unity}{CsoundUnity}} \_csound;}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00019}00019 }
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00020}00020         \textcolor{keywordtype}{void} Start()}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00021}00021         \{}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00022}00022             \_targetImage.texture = \mbox{\hyperlink{class_csound_1_1_granular_synthesis_1_1_partikkel_1_1_waveform_drawer_a40029f6543f85b947f447ef208cb7531}{PaintWaveformSpectrum}}(\_clip, 1, 512, 128, Color.white);}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00023}00023             \_progressBarRT = \_progressBar.GetComponent<RectTransform>();}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00024}00024             \_targetImageWidth = \_targetImage.GetComponent<RectTransform>().rect.width;}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00025}00025             \_csound = GetComponent<CsoundUnity>();}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00026}00026         \}}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00027}00027 }
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00028}00028         \textcolor{keywordtype}{void} Update()}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00029}00029         \{}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00030}00030             \_progressBarRT.anchoredPosition = \textcolor{keyword}{new} Vector2((\textcolor{keywordtype}{float})\_csound.\mbox{\hyperlink{class_csound_unity_adf9230e5932b098bacc1ee87369707e9}{GetChannel}}(\textcolor{stringliteral}{"{}samplepos"{}}) * \_targetImageWidth, 0);}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00031}00031         \}}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00032}00032 }
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00033}\mbox{\hyperlink{class_csound_1_1_granular_synthesis_1_1_partikkel_1_1_waveform_drawer_a40029f6543f85b947f447ef208cb7531}{00033}}         \textcolor{keyword}{public} Texture2D \mbox{\hyperlink{class_csound_1_1_granular_synthesis_1_1_partikkel_1_1_waveform_drawer_a40029f6543f85b947f447ef208cb7531}{PaintWaveformSpectrum}}(AudioClip audio, \textcolor{keywordtype}{float} saturation, \textcolor{keywordtype}{int} width, \textcolor{keywordtype}{int} height, Color col)}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00034}00034         \{}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00035}00035             Texture2D tex = \textcolor{keyword}{new} Texture2D(width, height, TextureFormat.RGBA32, \textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00036}00036             \textcolor{keywordtype}{float}[] samples = \textcolor{keyword}{new} \textcolor{keywordtype}{float}[audio.samples];}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00037}00037             \textcolor{keywordtype}{float}[] waveform = \textcolor{keyword}{new} \textcolor{keywordtype}{float}[width];}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00038}00038             audio.GetData(samples, 0);}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00039}00039             \textcolor{keywordtype}{int} packSize = (audio.samples / width) + 1;}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00040}00040             \textcolor{keywordtype}{int} s = 0;}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00041}00041             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < audio.samples; i += packSize)}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00042}00042             \{}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00043}00043                 waveform[s] = Mathf.Abs(samples[i]);}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00044}00044                 s++;}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00045}00045             \}}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00046}00046 }
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00047}00047             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} x = 0; x < width; x++)}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00048}00048             \{}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00049}00049                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} y = 0; y < height; y++)}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00050}00050                 \{}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00051}00051                     tex.SetPixel(x, y, Color.black);}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00052}00052                 \}}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00053}00053             \}}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00054}00054 }
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00055}00055             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} x = 0; x < waveform.Length; x++)}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00056}00056             \{}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00057}00057                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} y = 0; y <= waveform[x] * ((float)height * .75f); y++)}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00058}00058                 \{}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00059}00059                     tex.SetPixel(x, (height / 2) + y, col);}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00060}00060                     tex.SetPixel(x, (height / 2) -\/ y, col);}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00061}00061                 \}}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00062}00062             \}}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00063}00063             tex.Apply();}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00064}00064 }
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00065}00065             \textcolor{keywordflow}{return} tex;}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00066}00066         \}}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00067}00067     \}}
\DoxyCodeLine{\Hypertarget{_waveform_drawer_8cs_source_l00068}00068 \}}

\end{DoxyCode}
